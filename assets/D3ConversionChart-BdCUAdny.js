import{j as x}from"./index-kEMBa234.js";import{r as f}from"./icons-BrVv_MI0.js";import{g,r as C,l as v,i as D,t as L,u as b,v as O,o as Y,q,w as B,k as w}from"./d3-charts-5qgYJmbs.js";import"./react-vendor-DDxydHEc.js";import"./ui-utils-BznqKjY6.js";function I({data:s,colors:a}){const h=f.useRef(null),l=f.useRef(null),[p,k]=f.useState({width:0,height:0});return f.useEffect(()=>{if(!l.current)return;const c=new ResizeObserver(e=>{if(!e||e.length===0)return;const{width:d,height:i}=e[0].contentRect;k({width:d,height:i})});return c.observe(l.current),()=>c.disconnect()},[]),f.useEffect(()=>{if(!h.current||!s||p.width===0||p.height===0)return;const c=g(h.current);c.selectAll("*").remove();const e={top:20,right:40,left:40,bottom:30},d=p.width-e.left-e.right,i=p.height-e.top-e.bottom,r=c.append("g").attr("transform",`translate(${e.left},${e.top})`),n=C().domain(s.map(t=>t.week)).range([0,d]).padding(.1),m=v().domain([0,D(s,t=>t.applied)||0]).nice().range([i,0]),u=v().domain([0,100]).range([i,0]),y=g(l.current).append("div").style("position","absolute").style("visibility","hidden").style("background","white").style("border","1px solid #e2e8f0").style("padding","8px").style("border-radius","4px").style("box-shadow","0 2px 4px rgba(0,0,0,0.1)").style("font-size","12px").style("pointer-events","none").style("z-index","10"),R=L().x(t=>n(t.week)).y0(i).y1(t=>m(t.applied)).curve(b);r.append("path").datum(s).attr("fill",a.applied).attr("fill-opacity",.3).attr("stroke",a.applied).attr("stroke-width",1).attr("d",R);const $=O().x(t=>n(t.week)).y(t=>u(t.rate)).curve(b);r.append("path").datum(s).attr("fill","none").attr("stroke",a.rate).attr("stroke-width",3).attr("stroke-dasharray","4,4").attr("d",$),r.selectAll("circle").data(s).join("circle").attr("cx",t=>n(t.week)).attr("cy",t=>u(t.rate)).attr("r",4).attr("fill",a.rate),r.append("g").attr("transform",`translate(0,${i})`).call(Y(n)).style("font-size","11px").style("color","#64748b"),r.append("g").call(q(m).ticks(5)).style("font-size","11px").style("color","#64748b"),r.append("g").attr("transform",`translate(${d},0)`).call(B(u).ticks(5).tickFormat(t=>t+"%")).style("font-size","11px").style("color","#64748b");const z=n.step();r.append("rect").attr("width",d).attr("height",i).attr("fill","transparent").on("mousemove",t=>{const[A,F]=w(t),j=Math.round(A/z),o=s[j];if(!o)return;const[E,X]=w(t,l.current);y.style("visibility","visible").style("left",E+10+"px").style("top",X-10+"px").html(`
                        <div class="font-bold mb-1">${o.week}</div>
                        <div style="color:${a.applied}">Applied: ${o.applied}</div>
                        <div style="color:${a.rate}">Rate: ${o.rate}%</div>
                    `),r.selectAll(".cursor-line").remove(),r.append("line").attr("class","cursor-line").attr("x1",n(o.week)).attr("x2",n(o.week)).attr("y1",0).attr("y2",i).attr("stroke","#94a3b8").attr("stroke-dasharray","2,2")}).on("mouseout",()=>{y.style("visibility","hidden"),r.selectAll(".cursor-line").remove()})},[s,p,a]),x.jsx("div",{ref:l,className:"w-full h-full relative",children:x.jsx("svg",{ref:h,width:"100%",height:"100%",style:{overflow:"visible"}})})}export{I as D3ConversionChart};
