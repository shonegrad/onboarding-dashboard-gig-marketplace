import{j as b}from"./index-kEMBa234.js";import{r as c}from"./icons-BrVv_MI0.js";import{g as h,h as z,l as A,i as E,j as D,k as K,o as N,q as k}from"./d3-charts-5qgYJmbs.js";import"./react-vendor-DDxydHEc.js";import"./ui-utils-BznqKjY6.js";function T({data:r,onBarClick:d}){const g=c.useRef(null),o=c.useRef(null),[a,w]=c.useState({width:0,height:0});return c.useEffect(()=>{if(!o.current)return;const i=new ResizeObserver(e=>{if(!e||e.length===0)return;const{width:p,height:y}=e[0].contentRect;w({width:p,height:y})});return i.observe(o.current),()=>i.disconnect()},[]),c.useEffect(()=>{if(!g.current||!r||a.width===0||a.height===0)return;const i=h(g.current);i.selectAll("*").remove();const e={top:20,right:30,left:40,bottom:30},p=a.width-e.left-e.right,y=a.height-e.top-e.bottom,u=i.append("g").attr("transform",`translate(${e.left},${e.top})`),m=z().domain(r.map(t=>t.stage)).range([0,p]).padding(.3),n=A().domain([0,E(r,t=>t.total)||0]).nice().range([y,0]),$=D().keys(["current","progressed"])(r),f=h(o.current).append("div").style("position","absolute").style("visibility","hidden").style("background","white").style("border","1px solid #e2e8f0").style("padding","8px").style("border-radius","4px").style("box-shadow","0 2px 4px rgba(0,0,0,0.1)").style("font-size","12px").style("pointer-events","none").style("z-index","10");u.selectAll("g.layer").data($).join("g").attr("class","layer").selectAll("rect").data(t=>t).join("rect").attr("x",t=>m(t.data.stage)).attr("y",t=>n(t[1])).attr("height",t=>n(t[0])-n(t[1])).attr("width",m.bandwidth()).attr("fill",(t,s,l)=>h(l[s].parentNode).datum().key==="current"?t.data.color:t.data.progressColor).style("cursor",d?"pointer":"default").on("mouseover",(t,s)=>{const l=s.data.total,v=s.data.current,x=s.data.progressed;f.style("visibility","visible").html(`
                        <div class="font-bold mb-1">${s.data.stage}</div>
                        <div>Remaining: ${v}</div>
                        <div>Progressed: ${x}</div>
                        <div class="mt-1 pt-1 border-t text-xs text-gray-500">Total: ${l}</div>
                    `)}).on("mousemove",t=>{const[s,l]=K(t,o.current);f.style("left",s+10+"px").style("top",l-10+"px")}).on("mouseout",()=>{f.style("visibility","hidden")}).on("click",(t,s)=>{d&&d(s.data)});const R=N(m),j=k(n).ticks(5);u.append("g").attr("transform",`translate(0,${y})`).call(R).style("font-size","11px").style("color","#64748b"),u.append("g").call(j).style("font-size","11px").style("color","#64748b"),u.append("g").attr("class","grid").call(k(n).tickSize(-p).tickFormat(()=>"")).style("stroke-dasharray","3,3").style("stroke-opacity",.1).select(".domain").remove()},[r,a,d]),b.jsx("div",{ref:o,className:"w-full h-full relative",children:b.jsx("svg",{ref:g,width:"100%",height:"100%",style:{overflow:"visible"}})})}export{T as D3BarChart};
